// 20191007
// [BOJ. 17471] 게리맨더링
#if 01
#include <stdio.h>
#define MAX	(14)
#define INF	(987654321)
#define ABS(a)	( ((a) < 0) ? -(a) : (a) )

void Input(void);
void DFS(int L, int s_idx);
int BFS(int flag);
void Print(void);

int N;
int population[MAX];
int Injub[MAX][MAX];
int Visit[MAX];
int Q[MAX];
int Min_Diff;
int sumA, sumB;
int Wp, Rp;
int cnt;

int main(void)
{
	Input();
	DFS(1, 1);
	Print();

	return 0;
}

void Input(void)
{
	int i, tmp, ttmp;

	Min_Diff = INF;         cnt = 0;
	scanf("%d", &N);
	for (i = 1; i <= N; i++) scanf("%d", &population[i]);
	for (i = 1; i <= N; i++)
	{
		scanf("%d", &tmp);
		Injub[i][0] = tmp;
		while (tmp--)
		{
			scanf("%d", &ttmp);
			Injub[i][ttmp] = Injub[ttmp][i] = 1;
		}
	}
}

void DFS(int L, int s_idx)
{
	int i, j, check;

	if (Min_Diff == 0) return;
	if (L > N) return;
	if (L > 1)
	{
		//for(int k = 1; k <= N; k++) printf("%d ", Visit[k]);  printf("\n");
		if (BFS(1) && BFS(0))
		{
			sumA = sumB = 0;
			for (j = 1; j <= N; j++)
			{
				if (Visit[j]) sumA += population[j];
				else sumB += population[j];
			}
			check = ABS(sumA - sumB);
			if (Min_Diff > check) Min_Diff = check;
		}
	}

	for (i = s_idx; i <= N; i++)
	{
		if (Visit[i]) continue;
		Visit[i] = 1;   cnt++;
		DFS(L + 1, i + 1);
		Visit[i] = 0;   cnt--;
	}
}

int BFS(int flag)
{
	int Visit2[MAX] = { 0 };
	int count;
	int i, s, out;

	Wp = Rp = 0;
	for (i = 1; i <= N; i++)
	{
		if (Visit[i] == flag)
		{
			s = i;
			break;
		}
	}

	Visit2[s] = 1;
	Q[Wp++] = s;
	count = 1;
	while (Wp > Rp)
	{
		out = Q[Rp++];
		for (i = 1; i <= N; i++)
		{
			if (Visit[i] == flag && Visit2[i] == 0 && Injub[out][i] == 1)
			{
				Visit2[i] = 1;
				Q[Wp++] = i;
				count++;
			}
		}
	}

	if (flag && count == cnt) return 1;
	if (!flag && count == N - cnt) return 1;
	return 0;
}

void Print(void)
{
	/*
	for (int i = 0; i <= N; i++)
	{
		for (int j = 0; j <= N; j++)
		{
			printf("%d ", Injub[i][j]);
		}
		printf("\n");
	}
	printf("\n");
	*/

	printf("%d\n", ((Min_Diff == INF) ? -1 : Min_Diff));
}
#endif
